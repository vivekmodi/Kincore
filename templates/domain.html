<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Gene</title>
  </head>
  <body>
    {% extends 'base.html' %}
    {% block content %}
    <div class="container-fluid">
      <div class="row">
        <div class="col-lg-11 col-md-11 col-sm-11 col-xs-11">

          <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item">
              <a class="nav-link active" data-toggle="tab" role="tab" id="Human-tab" href="#Human" aria-controls="Human" aria-selected="true">Human</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" data-toggle="tab" id="All-tab" href="#All" role="tab" aria-controls="All" aria-selected="false">All</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" data-toggle="tab" id="Nonhuman-tab" href="#Nonhuman" role="tab" aria-controls="Nonhuman" aria-selected="false">Non-Human</a>
            </li>
          </ul>

          <div class="tab-content" id="myTabContent">
            <div class="tab-pane active" id="Human" role="tabpanel"  aria-labelledby="Human-tab">
              <div class="row">
                <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                  <div class="card  border-light bg-light mb-3 very-dark-text">
                    <div class="card-header light-pink-background"><h4>{{ geneName }} ({{ protein_name }})</h4></div>
                      <div class="card-body">
                        <h5 class="card-title">{{ geneName }} has two kinase domains in its sequence, labeled here as {{ geneName }}_1 and {{ geneName }}_2.</h5>
                        <h5 class="card-title">Domain_1: {{ geneName }}_1
                        {% if gene_list_1['Human'] %}
                        {% if first_entry_1['Human'].status=='Pseudo' %}
                         (Pseudokinase)
                        {% endif %}</h5>
                        <h5 class="card-title">Group: <a href="{{ url_for('uniqueQuery', queryname=first_entry_1['Human'].group, settings='GROUP') }}" target="_blank">{{ first_entry_1['Human'].group }}</a></h5>
                        <h5 class="card-title">Uniprot: <a href="https://www.uniprot.org/uniprot/{{ first_entry_1['Human'].uniprotid }}" target="_blank">{{ first_entry_1['Human'].uniprotid }}</a></h5>
                        <h5 class="card-title">Domain boundary: {{ first_entry_1['Human'].domain_begin }} - {{ first_entry_1['Human'].domain_end }}</h5><br>
                        {% endif %}
                        <h6 class="card-text">Total number of chains: {{ total_count_1['Human'] }}</h6>

                        {% if gene_list_1['Human'] %}
                        <div class="table-responsive">
                        <table class="table dark-text">
                          <thead class="">
                            <tr>
                              <th scope="col" style='text-align:left;'>Spatial</th>
                              <th scope="col" style='text-align:left;'>Dihedral</th>
                              <th scope="col" style='text-align:left;'>Chains</th>
                              <th scope="col" style='text-align:left;'>Representative</th>
                            </tr>
                          </thead>
                          {% for spatial in ('DFGin','DFGinter','DFGout','None') %}
                            {% for dihedral in ('BLAminus','BLAplus','ABAminus','BLBminus','BLBplus','BLBtrans','BABtrans','BBAminus','None') %}
                              {% if strCount_1_human[first_entry_1['Human'].group,spatial,dihedral]>0 %}
                                <tr style="line-height:10px;">
                                  <td style='text-align:left;'>{{ spatial }}</td>
                                  <td style='text-align:left;'>{{ dihedral }}</td>
                                  <td style='text-align:left;'>{{ strCount_1_human[first_entry_1['Human'].group,spatial,dihedral] }}</td>
                                  <td style="text-align:left;color:{{ clusterColor[dihedral] }};font-weight:bold;">{{ reprStr_1['Human',spatial,dihedral] }}</td>
                                </tr>
                              {% endif %}
                            {% endfor %}
                          {% endfor %}
                        </table>
                      </div>
                        {% endif %}
                      </div>
                    </div>

                    {% if gene_list_1['Human'] %}
                    <div class="btn-group" style="margin:5px;">
                      <button type="button" class="btn button-primary dropdown-toggle light-text" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Download in Pymol
                      </button>
                      <div class="dropdown-menu">
                        <h6 class="dropdown-header very-dark-text">All chains</h6>
                        {% if total_count_1['Human']>1000 %}
                        <h6 class="dropdown-item very-dark-text">No Pymol session because the query has >1000 chains</h6>
                        {% else %}
                        <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static',filename=pymolSession_1['Human']) }}">Pymol session(ver 2.3)</a>
                        {% endif %}
                        <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static',filename=pymolScript_1['Human']) }}">Pymol script</a>

                      </div>
                    </div>


                    <div class="btn-group" style="margin:5px;margin-left:40px;">
                      <button type="button" class="btn button-primary dropdown-toggle light-text" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Download coordinates
                      </button>
                      <div class="dropdown-menu">
                        <h6 class="dropdown-header very-dark-text">All chains - renumbered by</h6>
                        <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static', filename=coordinateFiles_1['Human']) }}_uniNum.zip">Uniprot</a>
                        <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static', filename=coordinateFiles_1['Human']) }}_pdbNum.zip">PDB</a>
                        <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static', filename=coordinateFiles_1['Human']) }}_alignNum.zip">Alignment</a>
                      </div>
                    </div>
                  {% endif %}
                  </div>


                    {% if gene_list_1['Human'] %}
                  <div class="col-lg-5 col-md-12 col-sm-12 col-xs-12 offset-lg-1">
                    <div id="viewport_1_human" style="width:100%; height:400px"></div>
                  </div>
                  {% endif %}

                <br>

                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                  {% if gene_list_1['Human'] %}
                  <a role="button" class="btn button-primary light-text" style="margin:5px;" href="{{ url_for('static', filename=tsvFile_1['Human']) }}">Database table as tsv</a>
                  <br>

                  <div class="table-responsive">
                  <div class="table table-striped table-hover sortable very-dark-text" style="word-wrap: break-word;">
                    <table class="table table-striped table-hover sortable very-dark-text">
                      <thead class=thead-light>
                        <tr>
                          <th scope="col">PDB</th>
                          <th scope="col">Resolution</th>
                          <th scope="col">Spatial Label</th>
                          <th scope="col">Dihedral Label</th>
                          <th scope="col">C-helix</th>
                          <th scope="col">Ligand</th>
                          <th scope="col">Type</th>
                          <th scope="col">Residues in structure</th>
                          <th scope="col" style="width:8%;">Mutation</th>
                          <th scope="col">Phosphorylation</th>
                          <th scope="col">Unresolved residues in A-loop</th>
                        </tr>
                      </thead>

                      {% for item in gene_list_1['Human'] %}

                          <tr>
                            <td><a href="{{ url_for('uniqueQuery', queryname=item.pdb, settings='PDB') }}" target="_blank">{{ item.pdb }}</td>
                            <td>{{ item.resolution }}</td>

                            <td><a href="{{ url_for('uniqueQuery', queryname=item.spatial, settings='SPATIAL') }}" target="_blank">{{ item.spatial }}</td>
                            {% if item.dihedral=='None' %}
                            <td><a href="{{ url_for('uniqueQuery', queryname=(item.spatial+item.dihedral), settings='DIHEDRAL') }}" target="_blank">{{ item.dihedral }}</td>
                            {% else %}
                            <td><a href="{{ url_for('uniqueQuery', queryname=item.dihedral, settings='DIHEDRAL') }}" target="_blank">{{ item.dihedral }}</td>
                            {% endif %}
                            <td>{{ item.chelix }}</td>

                            {% if ',' in item.ligand %}
                            <td>
                              {% set subitems=item.ligand.split(',') %}
                              {% for ligname in subitems %}
                              {% set sub_subitems=ligname.split(':') %}
                              <a href="{{ url_for('uniqueQuery', queryname=sub_subitems[0], settings='LIGAND') }}" target="_blank">{{ sub_subitems[0] }}
                              {% endfor %}
                            </td>
                            {% else %}
                            {% set ligname=item.ligand.split(':') %}
                            <td><a href="{{ url_for('uniqueQuery', queryname=ligname[0], settings='LIGAND') }}" target="_blank">{{ ligname[0] }}</td>
                            {% endif %}

                            {% if ',' in item.ligand_type %}
                            <td>
                            {% set subitems=item.ligand_type.split(',') %}
                            {% for ligtypes in subitems %}
                            <a href="{{ url_for('multipleQuery', groupSelect='All', labelSelect='All', ligTypeSelect=ligtypes) }}" target="_blank">{{ ligtypes }}
                            {% endfor %}
                          </td>
                          {% else %}
                            <td><a href="{{ url_for('multipleQuery', groupSelect='All', labelSelect='All', ligTypeSelect=item.ligand_type) }}" target="_blank">{{ item.ligand_type }}</td>
                          {% endif %}

                            <td>{{ item.first_obs_res }} - {{ item.last_obs_res }}</td>
                            <td>{{ item.chain_mut }}</td>
                            <td>{{ item.chain_phos }}</td>
                            {% if item.loopBreak>0 %}
                            <td>{{ item.loopBreak }}</td>
                            {% else %}
                            <td>0</td>
                            {% endif %}
                          </tr>

                        {% endfor %}
                    </table>
                  </div>
                  </div>
                  {% endif %}
                  <hr class="my-4">
                </div>

            </div>

                <div class="row">
                  <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                    <div class="card  border-light bg-light mb-3 very-dark-text">
                      <div class="card-header light-pink-background"><h4>{{ geneName }} ({{ protein_name }})</h4></div>
                        <div class="card-body">
                          <h5 class="card-title">Domain_2: {{ geneName }}_2
                          {% if gene_list_2['Human'] %}
                          {% if first_entry_2['Human'].status=='Pseudo' %}
                           (Pseudokinase)
                          {% endif %}</h5>
                          <h5 class="card-title">Group: <a href="{{ url_for('uniqueQuery', queryname=first_entry_2['Human'].group, settings='GROUP') }}" target="_blank">{{ first_entry_2['Human'].group }}</a></h5>
                          <h5 class="card-title">Uniprot: <a href="https://www.uniprot.org/uniprot/{{ first_entry_2['Human'].uniprotid }}" target="_blank">{{ first_entry_2['Human'].uniprotid }}</a></h5>
                          <h5 class="card-title">Domain boundary: {{ first_entry_2['Human'].domain_begin }} - {{ first_entry_2['Human'].domain_end }}</h5><br>
                          {% endif %}
                          <h6 class="card-text">Total number of chains in: {{ total_count_2['Human'] }}</h6>

                          {% if gene_list_2['Human'] %}
                          <div class="table-responsive">
                          <table class="table dark-text">
                            <thead class="">
                              <tr>
                                <th scope="col" style='text-align:left;'>Spatial</th>
                                <th scope="col" style='text-align:left;'>Dihedral</th>
                                <th scope="col" style='text-align:left;'>Chains</th>
                                <th scope="col" style='text-align:left;'>Representative</th>
                              </tr>
                            </thead>
                            {% for spatial in ('DFGin','DFGinter','DFGout','None') %}
                            {% for dihedral in ('BLAminus','BLAplus','ABAminus','BLBminus','BLBplus','BLBtrans','BABtrans','BBAminus','None') %}
                            {% if strCount_2_human[first_entry_2['Human'].group,spatial,dihedral]>0 %}
                            <tr style="line-height:10px;">
                              <td style='text-align:left;'>{{ spatial }}</td>
                              <td style='text-align:left;'>{{ dihedral }}</td>
                              <td style='text-align:left;'>{{ strCount_2_human[first_entry_2['Human'].group,spatial,dihedral] }}</td>
                              <td style="text-align:left;color:{{ clusterColor[dihedral] }};font-weight:bold;">{{ reprStr_2['Human',spatial,dihedral] }}</td>
                            </tr>
                            {% endif %}
                            {% endfor %}
                            {% endfor %}
                          </table>
                        </div>
                        </div>
                        {% endif %}
                      </div>

                      {% if gene_list_2['Human'] %}
                      <div class="btn-group" style="margin:5px;">
                        <button type="button" class="btn button-primary dropdown-toggle light-text" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                          Download in Pymol
                        </button>
                        <div class="dropdown-menu">
                          <h6 class="dropdown-header very-dark-text">All chains</h6>
                          {% if total_count_2['Human']>1000 %}
                          <h6 class="dropdown-item very-dark-text">No Pymol session because the query has >1000 chains</h6>
                          {% else %}
                          <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static',filename=pymolSession_2['Human']) }}">Pymol session(ver 2.3)</a>
                          {% endif %}
                          <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static',filename=pymolScript_2['Human']) }}">Pymol script</a>

                        </div>
                      </div>


                      <div class="btn-group" style="margin:5px;margin-left:40px;">
                        <button type="button" class="btn button-primary dropdown-toggle light-text" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                          Download coordinates
                        </button>
                        <div class="dropdown-menu">
                          <h6 class="dropdown-header very-dark-text">All chains - renumbered by</h6>
                          <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static', filename=coordinateFiles_2['Human']) }}_uniNum.zip">Uniprot</a>
                          <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static', filename=coordinateFiles_2['Human']) }}_pdbNum.zip">PDB</a>
                          <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static', filename=coordinateFiles_2['Human']) }}_alignNum.zip">Alignment</a>
                        </div>
                      </div>
                    {% endif %}
                  </div>


                      {% if gene_list_2['Human'] %}
                    <div class="col-lg-5 col-md-12 col-sm-12 col-xs-12 offset-lg-1">
                      <div id="viewport_2_human" style="width:100%; height:600px"></div>
                    </div>
                    {% endif %}
                  </div>
                  <br>
                <div class="row">
                  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                      {% if gene_list_2['Human'] %}
                      <a role="button" class="btn button-primary light-text" style="margin:5px;" href="{{ url_for('static', filename=tsvFile_2['Human']) }}">Database table as tsv</a>
                      <br>
                    <div class="table-responsive">
                      <table class="table table-striped table-hover sortable very-dark-text">
                        <thead class=thead-light>
                          <tr>
                            <th scope="col">PDB</th>
                            <th scope="col">Resolution</th>
                            <th scope="col">Spatial Label</th>
                            <th scope="col">Dihedral Label</th>
                            <th scope="col">C-helix</th>
                            <th scope="col">Ligand</th>
                            <th scope="col">Type</th>
                            <th scope="col">Residues in structure</th>
                            <th scope="col" style="width:8%;">Mutation</th>
                            <th scope="col">Phosphorylation</th>
                            <th scope="col">Unresolved residues in A-loop</th>
                          </tr>
                        </thead>

                        {% for item in gene_list_2['Human'] %}

                        <tr>
                          <td><a href="{{ url_for('uniqueQuery', queryname=item.pdb, settings='PDB') }}" target="_blank">{{ item.pdb }}</td>
                          <td>{{ item.resolution }}</td>

                          <td><a href="{{ url_for('uniqueQuery', queryname=item.spatial, settings='SPATIAL') }}" target="_blank">{{ item.spatial }}</td>
                          {% if item.dihedral=='None' %}
                          <td><a href="{{ url_for('uniqueQuery', queryname=(item.spatial+item.dihedral), settings='DIHEDRAL') }}" target="_blank">{{ item.dihedral }}</td>
                          {% else %}
                          <td><a href="{{ url_for('uniqueQuery', queryname=item.dihedral, settings='DIHEDRAL') }}" target="_blank">{{ item.dihedral }}</td>
                          {% endif %}
                          <td>{{ item.chelix }}</td>

                          {% if ',' in item.ligand %}
                          <td>
                            {% set subitems=item.ligand.split(',') %}
                            {% for ligname in subitems %}
                            {% set sub_subitems=ligname.split(':') %}
                            <a href="{{ url_for('uniqueQuery', queryname=sub_subitems[0], settings='LIGAND') }}" target="_blank">{{ sub_subitems[0] }}
                            {% endfor %}
                          </td>
                          {% else %}
                          {% set ligname=item.ligand.split(':') %}
                          <td><a href="{{ url_for('uniqueQuery', queryname=ligname[0], settings='LIGAND') }}" target="_blank">{{ ligname[0] }}</td>
                          {% endif %}

                          {% if ',' in item.ligand_type %}
                          <td>
                          {% set subitems=item.ligand_type.split(',') %}
                          {% for ligtypes in subitems %}
                          <a href="{{ url_for('multipleQuery', groupSelect='All', labelSelect='All', ligTypeSelect=ligtypes) }}" target="_blank">{{ ligtypes }}
                          {% endfor %}
                        </td>
                        {% else %}
                          <td><a href="{{ url_for('multipleQuery', groupSelect='All', labelSelect='All', ligTypeSelect=item.ligand_type) }}" target="_blank">{{ item.ligand_type }}</td>
                        {% endif %}

                          <td>{{ item.first_obs_res }} - {{ item.last_obs_res }}</td>
                          <td>{{ item.chain_mut }}</td>
                          <td>{{ item.chain_phos }}</td>
                          {% if item.loopBreak>0 %}
                          <td>{{ item.loopBreak }}</td>
                          {% else %}
                          <td>0</td>
                          {% endif %}
                        </tr>

                        {% endfor %}
                      </table>
                    </div>
                    {% endif %}
                  </div>
                </div>
              </div>


              <div class="tab-pane active" id="All" role="tabpanel"  aria-labelledby="All-tab">
                <div class="row">
                  <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                    <div class="card  border-light bg-light mb-3 very-dark-text">
                      <div class="card-header light-pink-background"><h4>{{ geneName }} ({{ protein_name }})</h4></div>
                        <div class="card-body">
                          <h5 class="card-title">{{ geneName }} has two kinase domains in its sequence, labeled here as {{ geneName }}_1 and {{ geneName }}_2.</h5>
                          <h5 class="card-title">Domain_1: {{ geneName }}_1
                          {% if gene_list_1['All'] %}
                          {% if first_entry_1['All'].status=='Pseudo' %}
                           (Pseudokinase)
                          {% endif %}</h5>
                          <h5 class="card-title">Group: <a href="{{ url_for('uniqueQuery', queryname=first_entry_1['All'].group, settings='GROUP') }}" target="_blank">{{ first_entry_1['All'].group }}</a></h5>
                          <h5 class="card-title">Uniprot: <a href="https://www.uniprot.org/uniprot/{{ first_entry_1['All'].uniprotid }}" target="_blank">{{ first_entry_1['All'].uniprotid }}</a></h5>
                          <h5 class="card-title">Domain boundary: {{ first_entry_1['All'].domain_begin }} - {{ first_entry_1['All'].domain_end }}</h5><br>
                          {% endif %}
                          <h6 class="card-text">Total number of chains: {{ total_count_1['All'] }}</h6>

                          {% if gene_list_1['All'] %}
                          <div class="table-responsive">
                          <table class="table dark-text">
                            <thead class="">
                              <tr>
                                <th scope="col" style='text-align:left;'>Spatial</th>
                                <th scope="col" style='text-align:left;'>Dihedral</th>
                                <th scope="col" style='text-align:left;'>Chains</th>
                                <th scope="col" style='text-align:left;'>Representative</th>
                              </tr>
                            </thead>
                            {% for spatial in ('DFGin','DFGinter','DFGout','None') %}
                              {% for dihedral in ('BLAminus','BLAplus','ABAminus','BLBminus','BLBplus','BLBtrans','BABtrans','BBAminus','None') %}
                                {% if strCount_1_all[first_entry_1['All'].group,spatial,dihedral]>0 %}
                                  <tr style="line-height:10px;">
                                    <td style='text-align:left;'>{{ spatial }}</td>
                                    <td style='text-align:left;'>{{ dihedral }}</td>
                                    <td style='text-align:left;'>{{ strCount_1_all[first_entry_1['All'].group,spatial,dihedral] }}</td>
                                    <td style="text-align:left;color:{{ clusterColor[dihedral] }};font-weight:bold;">{{ reprStr_1['All',spatial,dihedral] }}</td>
                                  </tr>
                                {% endif %}
                              {% endfor %}
                            {% endfor %}
                          </table>
                        </div>
                          {% endif %}
                        </div>
                      </div>

                      {% if gene_list_1['All'] %}
                      <div class="btn-group" style="margin:5px;">
                        <button type="button" class="btn button-primary dropdown-toggle light-text" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                          Download in Pymol
                        </button>
                        <div class="dropdown-menu">
                          <h6 class="dropdown-header very-dark-text">All chains</h6>
                          {% if total_count_1['All']>1000 %}
                          <h6 class="dropdown-item very-dark-text">No Pymol session because the query has >1000 chains</h6>
                          {% else %}
                          <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static',filename=pymolSession_1['All']) }}">Pymol session(ver 2.3)</a>
                          {% endif %}
                          <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static',filename=pymolScript_1['All']) }}">Pymol script</a>

                        </div>
                      </div>


                      <div class="btn-group" style="margin:5px;margin-left:40px;">
                        <button type="button" class="btn button-primary dropdown-toggle light-text" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                          Download coordinates
                        </button>
                        <div class="dropdown-menu">
                          <h6 class="dropdown-header very-dark-text">All chains - renumbered by</h6>
                          <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static', filename=coordinateFiles_1['All']) }}_uniNum.zip">Uniprot</a>
                          <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static', filename=coordinateFiles_1['All']) }}_pdbNum.zip">PDB</a>
                          <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static', filename=coordinateFiles_1['All']) }}_alignNum.zip">Alignment</a>
                        </div>
                      </div>
                    {% endif %}
                    </div>


                      {% if gene_list_1['All'] %}
                    <div class="col-lg-5 col-md-12 col-sm-12 col-xs-12 offset-lg-1">
                      <div id="viewport_1_all" style="width:100%; height:600px"></div>
                    </div>
                    {% endif %}

                  <br>

                  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    {% if gene_list_1['All'] %}
                    <a role="button" class="btn button-primary light-text" style="margin:5px;" href="{{ url_for('static', filename=tsvFile_1['All']) }}">Database table as tsv</a>
                    <br>

                    <div class="table-responsive">
                      <table class="table table-striped table-hover sortable very-dark-text">
                        <thead class=thead-light>
                          <tr>
                            <th scope="col">Organism</th>
                            <th scope="col">UniprotID</th>
                            <th scope="col">PDB</th>
                            <th scope="col">Resolution</th>
                            <th scope="col">Spatial Label</th>
                            <th scope="col">Dihedral Label</th>
                            <th scope="col">C-helix</th>
                            <th scope="col">Ligand</th>
                            <th scope="col">Type</th>
                            <th scope="col">Residues in structure</th>
                            <th scope="col" style="width:8%;">Mutation</th>
                            <th scope="col">Phosphorylation</th>
                            <th scope="col">Unresolved residues in A-loop</th>
                          </tr>
                        </thead>

                        {% for item in gene_list_1['All'] %}
                        <tr>
                        <td>{{ item.specie }}</td>
                        <td>{{ item.uniprotid }}</td>
                        <td><a href="{{ url_for('uniqueQuery', queryname=item.pdb, settings='PDB') }}" target="_blank">{{ item.pdb }}</td>
                        <td>{{ item.resolution }}</td>
                        <td><a href="{{ url_for('uniqueQuery', queryname=item.spatial, settings='SPATIAL') }}" target="_blank">{{ item.spatial }}</td>
                        {% if item.dihedral=='None' %}
                        <td><a href="{{ url_for('uniqueQuery', queryname=(item.spatial+item.dihedral), settings='DIHEDRAL') }}" target="_blank">{{ item.dihedral }}</td>
                        {% else %}
                        <td><a href="{{ url_for('uniqueQuery', queryname=item.dihedral, settings='DIHEDRAL') }}" target="_blank">{{ item.dihedral }}</td>
                        {% endif %}
                        <td>{{ item.chelix }}</td>
                        {% if ',' in item.ligand %}
                        <td>
                          {% set subitems=item.ligand.split(',') %}
                          {% for ligname in subitems %}
                          {% set sub_subitems=ligname.split(':') %}
                          <a href="{{ url_for('uniqueQuery', queryname=sub_subitems[0], settings='LIGAND') }}" target="_blank">{{ sub_subitems[0] }}
                          {% endfor %}
                        </td>
                        {% else %}
                        {% set ligname=item.ligand.split(':') %}
                        <td><a href="{{ url_for('uniqueQuery', queryname=ligname[0], settings='LIGAND') }}" target="_blank">{{ ligname[0] }}</td>
                        {% endif %}
                        {% if ',' in item.ligand_type %}
                        <td>
                        {% set subitems=item.ligand_type.split(',') %}
                        {% for ligtypes in subitems %}
                        <a href="{{ url_for('multipleQuery', groupSelect='All', labelSelect='All', ligTypeSelect=ligtypes) }}" target="_blank">{{ ligtypes }}
                        {% endfor %}
                      </td>
                      {% else %}
                        <td><a href="{{ url_for('multipleQuery', groupSelect='All', labelSelect='All', ligTypeSelect=item.ligand_type) }}" target="_blank">{{ item.ligand_type }}</td>
                      {% endif %}

                        <td>{{ item.first_obs_res }} - {{ item.last_obs_res }}</td>
                        <td>{{ item.chain_mut }}</td>
                        <td>{{ item.chain_phos }}</td>
                        {% if item.loopBreak>0 %}
                        <td>{{ item.loopBreak }}</td>
                        {% else %}
                        <td>0</td>
                        {% endif %}
                      </tr>
                          {% endfor %}
                      </table>
                    </div>
                    {% endif %}
                    <hr class="my-4">
                  </div>
                  </div>


                  <div class="row">
                    <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                      <div class="card  border-light bg-light mb-3 very-dark-text">
                        <div class="card-header light-pink-background"><h4>{{ geneName }} ({{ protein_name }})</h4></div>
                          <div class="card-body">
                            <h5 class="card-title">Domain_2: {{ geneName }}_2
                            {% if gene_list_2['All'] %}
                            {% if first_entry_2['All'].status=='Pseudo' %}
                             (Pseudokinase)
                            {% endif %}</h5>
                            <h5 class="card-title">Group: <a href="{{ url_for('uniqueQuery', queryname=first_entry_2['All'].group, settings='GROUP') }}" target="_blank">{{ first_entry_2['All'].group }}</a></h5>
                            <h5 class="card-title">Uniprot: <a href="https://www.uniprot.org/uniprot/{{ first_entry_2['All'].uniprotid }}" target="_blank">{{ first_entry_2['All'].uniprotid }}</a></h5>
                            <h5 class="card-title">Domain boundary: {{ first_entry_2['All'].domain_begin }} - {{ first_entry_2['All'].domain_end }}</h5><br>
                            {% endif %}
                            <h6 class="card-text">Total number of chains in: {{ total_count_2['All'] }}</h6>

                            {% if gene_list_2['All'] %}
                            <div class="table-responsive">
                            <table class="table dark-text">
                              <thead class="">
                                <tr>
                                  <th scope="col" style='text-align:left;'>Spatial</th>
                                  <th scope="col" style='text-align:left;'>Dihedral</th>
                                  <th scope="col" style='text-align:left;'>Chains</th>
                                  <th scope="col" style='text-align:left;'>Representative</th>
                                </tr>
                              </thead>
                              {% for spatial in ('DFGin','DFGinter','DFGout','None') %}
                              {% for dihedral in ('BLAminus','BLAplus','ABAminus','BLBminus','BLBplus','BLBtrans','BABtrans','BBAminus','None') %}
                              {% if strCount_2_all[first_entry_2['All'].group,spatial,dihedral]>0 %}
                              <tr style="line-height:10px;">
                                <td style='text-align:left;'>{{ spatial }}</td>
                                <td style='text-align:left;'>{{ dihedral }}</td>
                                <td style='text-align:left;'>{{ strCount_2_all[first_entry_2['All'].group,spatial,dihedral] }}</td>
                                <td style="text-align:left;color:{{ clusterColor[dihedral] }};font-weight:bold;">{{ reprStr_2['All',spatial,dihedral] }}</td>
                              </tr>
                              {% endif %}
                              {% endfor %}
                              {% endfor %}
                            </table>
                          </div>
                          </div>
                          {% endif %}
                        </div>

                        {% if gene_list_2['All'] %}
                        <div class="btn-group" style="margin:5px;">
                          <button type="button" class="btn button-primary dropdown-toggle light-text" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Download in Pymol
                          </button>
                          <div class="dropdown-menu">
                            <h6 class="dropdown-header very-dark-text">All chains</h6>
                            {% if total_count_2['All']>1000 %}
                            <h6 class="dropdown-item very-dark-text">No Pymol session because the query has >1000 chains</h6>
                            {% else %}
                            <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static',filename=pymolSession_2['All']) }}">Pymol session(ver 2.3)</a>
                            {% endif %}
                            <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static',filename=pymolScript_2['All']) }}">Pymol script</a>

                          </div>
                        </div>


                        <div class="btn-group" style="margin:5px;margin-left:40px;">
                          <button type="button" class="btn button-primary dropdown-toggle light-text" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Download coordinates
                          </button>
                          <div class="dropdown-menu">
                            <h6 class="dropdown-header very-dark-text">All chains - renumbered by</h6>
                            <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static', filename=coordinateFiles_2['All']) }}_uniNum.zip">Uniprot</a>
                            <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static', filename=coordinateFiles_2['All']) }}_pdbNum.zip">PDB</a>
                            <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static', filename=coordinateFiles_2['All']) }}_alignNum.zip">Alignment</a>
                          </div>
                        </div>
                      {% endif %}
                    </div>


                        {% if gene_list_2['All'] %}
                      <div class="col-lg-5 col-md-12 col-sm-12 col-xs-12 offset-lg-1">
                        <div id="viewport_2_all" style="width:100%; height:600px"></div>
                      </div>
                      {% endif %}

                    <br>

                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        {% if gene_list_2['All'] %}
                        <a role="button" class="btn button-primary light-text" style="margin:5px;" href="{{ url_for('static', filename=tsvFile_2['All']) }}">Database table as tsv</a>
                        <br>
                      <div class="table-responsive">
                        <table class="table table-striped table-hover sortable very-dark-text">
                          <thead class=thead-light>
                            <tr>
                              <th scope="col">Organism</th>
                              <th scope="col">UniprotID</th>
                              <th scope="col">PDB</th>
                              <th scope="col">Resolution</th>
                              <th scope="col">Spatial Label</th>
                              <th scope="col">Dihedral Label</th>
                              <th scope="col">C-helix</th>
                              <th scope="col">Ligand</th>
                              <th scope="col">Type</th>
                              <th scope="col">Residues in structure</th>
                              <th scope="col" style="width:8%;">Mutation</th>
                              <th scope="col">Phosphorylation</th>
                              <th scope="col">Unresolved residues in A-loop</th>
                            </tr>
                          </thead>

                          {% for item in gene_list_2['All'] %}
                          <tr>
                            <td>{{ item.specie }}</td>
                            <td>{{ item.uniprotid }}</td>
                            <td><a href="{{ url_for('uniqueQuery', queryname=item.pdb, settings='PDB') }}" target="_blank">{{ item.pdb }}</td>
                            <td>{{ item.resolution }}</td>
                            <td><a href="{{ url_for('uniqueQuery', queryname=item.spatial, settings='SPATIAL') }}" target="_blank">{{ item.spatial }}</td>
                            {% if item.dihedral=='None' %}
                            <td><a href="{{ url_for('uniqueQuery', queryname=(item.spatial+item.dihedral), settings='DIHEDRAL') }}" target="_blank">{{ item.dihedral }}</td>
                            {% else %}
                            <td><a href="{{ url_for('uniqueQuery', queryname=item.dihedral, settings='DIHEDRAL') }}" target="_blank">{{ item.dihedral }}</td>
                            {% endif %}
                            <td>{{ item.chelix }}</td>
                            {% if ',' in item.ligand %}
                            <td>
                              {% set subitems=item.ligand.split(',') %}
                              {% for ligname in subitems %}
                              {% set sub_subitems=ligname.split(':') %}
                              <a href="{{ url_for('uniqueQuery', queryname=sub_subitems[0], settings='LIGAND') }}" target="_blank">{{ sub_subitems[0] }}
                              {% endfor %}
                            </td>
                            {% else %}
                            {% set ligname=item.ligand.split(':') %}
                            <td><a href="{{ url_for('uniqueQuery', queryname=ligname[0], settings='LIGAND') }}" target="_blank">{{ ligname[0] }}</td>
                            {% endif %}
                            {% if ',' in item.ligand_type %}
                            <td>
                            {% set subitems=item.ligand_type.split(',') %}
                            {% for ligtypes in subitems %}
                            <a href="{{ url_for('multipleQuery', groupSelect='All', labelSelect='All', ligTypeSelect=ligtypes) }}" target="_blank">{{ ligtypes }}
                            {% endfor %}
                          </td>
                          {% else %}
                            <td><a href="{{ url_for('multipleQuery', groupSelect='All', labelSelect='All', ligTypeSelect=item.ligand_type) }}" target="_blank">{{ item.ligand_type }}</td>
                          {% endif %}

                            <td>{{ item.first_obs_res }} - {{ item.last_obs_res }}</td>
                            <td>{{ item.chain_mut }}</td>
                            <td>{{ item.chain_phos }}</td>
                            {% if item.loopBreak>0 %}
                            <td>{{ item.loopBreak }}</td>
                            {% else %}
                            <td>0</td>
                            {% endif %}
                          </tr>
                          {% endfor %}
                        </table>
                      </div>
                      {% endif %}
                    </div>
                  </div>
                </div>


                <div class="tab-pane active" id="Nonhuman" role="tabpanel"  aria-labelledby="Nonhuman-tab">
                  <div class="row">
                    <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                      <div class="card  border-light bg-light mb-3 very-dark-text">
                        <div class="card-header light-pink-background"><h4>{{ geneName }} ({{ protein_name }})</h4></div>
                          <div class="card-body">
                            {% if total_count_1['Nonhuman']==0 %}
                            <h5 class="card-title">No non-human structures known</h5>
                            {% endif %}
                            {% if gene_list_1['Nonhuman'] %}
                            <h5 class="card-title">{{ geneName }} has two kinase domains in its sequence, labeled here as {{ geneName }}_1 and {{ geneName }}_2.</h5>
                            <h5 class="card-title">Domain_1: {{ geneName }}_1

                            {% if first_entry_1['Nonhuman'].status=='Pseudo' %}
                             (Pseudokinase)
                            {% endif %}</h5>
                            <h5 class="card-title">Group: <a href="{{ url_for('uniqueQuery', queryname=first_entry_1['Nonhuman'].group, settings='GROUP') }}" target="_blank">{{ first_entry_1['Nonhuman'].group }}</a></h5>
                            <h5 class="card-title">Uniprot: <a href="https://www.uniprot.org/uniprot/{{ first_entry_1['Nonhuman'].uniprotid }}" target="_blank">{{ first_entry_1['Nonhuman'].uniprotid }}</a></h5>
                            <h5 class="card-title">Domain boundary: {{ first_entry_1['Nonhuman'].domain_begin }} - {{ first_entry_1['Nonhuman'].domain_end }}</h5><br>
                            <h6 class="card-text">Total number of chains: {{ total_count_1['Nonhuman'] }}</h6>
                            {% endif %}
                            {% if gene_list_1['Nonhuman'] %}
                            <div class="table-responsive">
                            <table class="table dark-text">
                              <thead class="">
                                <tr>
                                  <th scope="col" style='text-align:left;'>Spatial</th>
                                  <th scope="col" style='text-align:left;'>Dihedral</th>
                                  <th scope="col" style='text-align:left;'>Chains</th>
                                  <th scope="col" style='text-align:left;'>Representative</th>
                                </tr>
                              </thead>
                              {% for spatial in ('DFGin','DFGinter','DFGout','None') %}
                                {% for dihedral in ('BLAminus','BLAplus','ABAminus','BLBminus','BLBplus','BLBtrans','BABtrans','BBAminus','None') %}
                                  {% if strCount_1_nonhuman[first_entry_1['Nonhuman'].group,spatial,dihedral]>0 %}
                                    <tr style="line-height:10px;">
                                      <td style='text-align:left;'>{{ spatial }}</td>
                                      <td style='text-align:left;'>{{ dihedral }}</td>
                                      <td style='text-align:left;'>{{ strCount_1_nonhuman[first_entry_1['Nonhuman'].group,spatial,dihedral] }}</td>
                                      <td style="text-align:left;color:{{ clusterColor[dihedral] }};font-weight:bold;">{{ reprStr_1['Nonhuman',spatial,dihedral] }}</td>
                                    </tr>
                                  {% endif %}
                                {% endfor %}
                              {% endfor %}
                            </table>
                          </div>
                            {% endif %}
                          </div>
                        </div>

                        {% if gene_list_1['Nonhuman'] %}
                        <div class="btn-group" style="margin:5px;">
                          <button type="button" class="btn button-primary dropdown-toggle light-text" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Download in Pymol
                          </button>
                          <div class="dropdown-menu">
                            <h6 class="dropdown-header very-dark-text">All chains</h6>
                            {% if total_count_1['Nonhuman']>1000 %}
                            <h6 class="dropdown-item very-dark-text">No Pymol session because the query has >1000 chains</h6>
                            {% else %}
                            <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static',filename=pymolSession_1['Nonhuman']) }}">Pymol session(ver 2.3)</a>
                            {% endif %}
                            <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static',filename=pymolScript_1['Nonhuman']) }}">Pymol script</a>

                          </div>
                        </div>


                        <div class="btn-group" style="margin:5px;margin-left:40px;">
                          <button type="button" class="btn button-primary dropdown-toggle light-text" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Download coordinates
                          </button>
                          <div class="dropdown-menu">
                            <h6 class="dropdown-header very-dark-text">All chains - renumbered by</h6>
                            <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static', filename=coordinateFiles_1['Nonhuman']) }}_uniNum.zip">Uniprot</a>
                            <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static', filename=coordinateFiles_1['Nonhuman']) }}_pdbNum.zip">PDB</a>
                            <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static', filename=coordinateFiles_1['Nonhuman']) }}_alignNum.zip">Alignment</a>
                          </div>
                        </div>
                      {% endif %}
                      </div>


                        {% if gene_list_1['Nonhuman'] %}
                      <div class="col-lg-5 col-md-12 col-sm-12 col-xs-12 offset-lg-1">
                        <div id="viewport_1_nonhuman" style="width:100%; height:600px"></div>
                      </div>
                      {% endif %}

                    <br>

                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                      {% if gene_list_1['Nonhuman'] %}
                      <a role="button" class="btn button-primary light-text" style="margin:5px;" href="{{ url_for('static', filename=tsvFile_1['Nonhuman']) }}">Database table as tsv</a>
                      <br>

                      <div class="table-responsive">
                        <table class="table table-striped table-hover sortable very-dark-text">
                          <thead class=thead-light>
                            <tr>
                                <th scope="col">Organism</th>
                                <th scope="col">UniprotID</th>
                                <th scope="col">PDB</th>
                                <th scope="col">Resolution</th>
                                <th scope="col">Spatial Label</th>
                                <th scope="col">Dihedral Label</th>
                                <th scope="col">C-helix</th>
                                <th scope="col">Ligand</th>
                                <th scope="col">Type</th>
                                <th scope="col">Residues in structure</th>
                                <th scope="col" style="width:8%;">Mutation</th>
                                <th scope="col">Phosphorylation</th>
                                <th scope="col">Unresolved residues in A-loop</th>
                              </tr>
                          </thead>

                          {% for item in gene_list_1['Nonhuman'] %}

                          <tr>
                            <td>{{ item.specie }}</td>
                            <td>{{ item.uniprotid }}</td>
                            <td><a href="{{ url_for('uniqueQuery', queryname=item.pdb, settings='PDB') }}" target="_blank">{{ item.pdb }}</td>
                            <td>{{ item.resolution }}</td>
                            <td><a href="{{ url_for('uniqueQuery', queryname=item.spatial, settings='SPATIAL') }}" target="_blank">{{ item.spatial }}</td>
                            {% if item.dihedral=='None' %}
                            <td><a href="{{ url_for('uniqueQuery', queryname=(item.spatial+item.dihedral), settings='DIHEDRAL') }}" target="_blank">{{ item.dihedral }}</td>
                            {% else %}
                            <td><a href="{{ url_for('uniqueQuery', queryname=item.dihedral, settings='DIHEDRAL') }}" target="_blank">{{ item.dihedral }}</td>
                            {% endif %}
                            <td>{{ item.chelix }}</td>
                            {% if ',' in item.ligand %}
                            <td>
                              {% set subitems=item.ligand.split(',') %}
                              {% for ligname in subitems %}
                              {% set sub_subitems=ligname.split(':') %}
                              <a href="{{ url_for('uniqueQuery', queryname=sub_subitems[0], settings='LIGAND') }}" target="_blank">{{ sub_subitems[0] }}
                              {% endfor %}
                            </td>
                            {% else %}
                            {% set ligname=item.ligand.split(':') %}
                            <td><a href="{{ url_for('uniqueQuery', queryname=ligname[0], settings='LIGAND') }}" target="_blank">{{ ligname[0] }}</td>
                            {% endif %}
                            {% if ',' in item.ligand_type %}
                            <td>
                            {% set subitems=item.ligand_type.split(',') %}
                            {% for ligtypes in subitems %}
                            <a href="{{ url_for('multipleQuery', groupSelect='All', labelSelect='All', ligTypeSelect=ligtypes) }}" target="_blank">{{ ligtypes }}
                            {% endfor %}
                          </td>
                          {% else %}
                            <td><a href="{{ url_for('multipleQuery', groupSelect='All', labelSelect='All', ligTypeSelect=item.ligand_type) }}" target="_blank">{{ item.ligand_type }}</td>
                          {% endif %}

                            <td>{{ item.first_obs_res }} - {{ item.last_obs_res }}</td>
                            <td>{{ item.chain_mut }}</td>
                            <td>{{ item.chain_phos }}</td>
                            {% if item.loopBreak>0 %}
                            <td>{{ item.loopBreak }}</td>
                            {% else %}
                            <td>0</td>
                            {% endif %}
                          </tr>

                            {% endfor %}
                        </table>
                      </div>
                      {% endif %}
                      <hr class="my-4">
                    </div>
                  </div>

                    <div class="row">
                      <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                        <div class="card  border-light bg-light mb-3 very-dark-text">
                          <div class="card-header light-pink-background"><h4>{{ geneName }} ({{ protein_name }})</h4></div>
                            <div class="card-body">
                              {% if total_count_2['Nonhuman']==0 %}
                              <h5 class="card-title">No non-human structures known</h5>
                              {% endif %}
                              {% if gene_list_2['Nonhuman'] %}
                              <h5 class="card-title">Domain_2: {{ geneName }}_2

                              {% if first_entry_2['Nonhuman'].status=='Pseudo' %}
                               (Pseudokinase)
                              {% endif %}</h5>
                              <h5 class="card-title">Group: <a href="{{ url_for('uniqueQuery', queryname=first_entry_2['Nonhuman'].group, settings='GROUP') }}" target="_blank">{{ first_entry_2['Nonhuman'].group }}</a></h5>
                              <h5 class="card-title">Uniprot: <a href="https://www.uniprot.org/uniprot/{{ first_entry_2['Nonhuman'].uniprotid }}" target="_blank">{{ first_entry_2['Nonhuman'].uniprotid }}</a></h5>
                              <h5 class="card-title">Domain boundary: {{ first_entry_2['Nonhuman'].domain_begin }} - {{ first_entry_2['Nonhuman'].domain_end }}</h5><br>

                              <h6 class="card-text">Total number of chains in: {{ total_count_2['Nonhuman'] }}</h6>
                              {% endif %}
                              {% if gene_list_2['Nonhuman'] %}
                              <div class="table-responsive">
                              <table class="table dark-text">
                                <thead class="">
                                  <tr>
                                    <th scope="col" style='text-align:left;'>Spatial</th>
                                    <th scope="col" style='text-align:left;'>Dihedral</th>
                                    <th scope="col" style='text-align:left;'>Chains</th>
                                    <th scope="col" style='text-align:left;'>Representative</th>
                                  </tr>
                                </thead>
                                {% for spatial in ('DFGin','DFGinter','DFGout','None') %}
                                {% for dihedral in ('BLAminus','BLAplus','ABAminus','BLBminus','BLBplus','BLBtrans','BABtrans','BBAminus','None') %}
                                {% if strCount_2_nonhuman[first_entry_2['Nonhuman'].group,spatial,dihedral]>0 %}
                                <tr style="line-height:10px;">
                                  <td style='text-align:left;'>{{ spatial }}</td>
                                  <td style='text-align:left;'>{{ dihedral }}</td>
                                  <td style='text-align:left;'>{{ strCount_2_nonhuman[first_entry_2['Nonhuman'].group,spatial,dihedral] }}</td>
                                  <td style="text-align:left;color:{{ clusterColor[dihedral] }};font-weight:bold;">{{ reprStr_2['Nonhuman',spatial,dihedral] }}</td>
                                </tr>
                                {% endif %}
                                {% endfor %}
                                {% endfor %}
                              </table>
                            </div>
                            </div>
                            {% endif %}
                          </div>

                          {% if gene_list_2['Nonhuman'] %}
                          <div class="btn-group" style="margin:5px;">
                            <button type="button" class="btn button-primary dropdown-toggle light-text" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                              Download in Pymol
                            </button>
                            <div class="dropdown-menu">
                              <h6 class="dropdown-header very-dark-text">All chains</h6>
                              {% if total_count_2['Nonhuman']>1000 %}
                              <h6 class="dropdown-item very-dark-text">No Pymol session because the query has >1000 chains</h6>
                              {% else %}
                              <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static',filename=pymolSession_2['Nonhuman']) }}">Pymol session(ver 2.3)</a>
                              {% endif %}
                              <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static',filename=pymolScript_2['Nonhuman']) }}">Pymol script</a>

                            </div>
                          </div>


                          <div class="btn-group" style="margin:5px;margin-left:40px;">
                            <button type="button" class="btn button-primary dropdown-toggle light-text" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                              Download coordinates
                            </button>
                            <div class="dropdown-menu">
                              <h6 class="dropdown-header very-dark-text">All chains - renumbered by</h6>
                              <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static', filename=coordinateFiles_2['Nonhuman']) }}_uniNum.zip">Uniprot</a>
                              <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static', filename=coordinateFiles_2['Nonhuman']) }}_pdbNum.zip">PDB</a>
                              <a class="dropdown-item" style='color: #0683bf;' href="{{ url_for('static', filename=coordinateFiles_2['Nonhuman']) }}_alignNum.zip">Alignment</a>
                            </div>
                          </div>
                        {% endif %}
                      </div>


                          {% if gene_list_2['Nonhuman'] %}
                        <div class="col-lg-5 col-md-12 col-sm-12 col-xs-12 offset-lg-1">
                          <div id="viewport_2_nonhuman" style="width:100%; height:600px"></div>
                        </div>
                        {% endif %}

                      <br>
                      <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                          {% if gene_list_2['Nonhuman'] %}
                          <a role="button" class="btn button-primary light-text" style="margin:5px;" href="{{ url_for('static', filename=tsvFile_2['Nonhuman']) }}">Database table as tsv</a>
                          <br>
                        <div class="table-responsive">
                          <table class="table table-striped table-hover sortable very-dark-text">
                            <thead class=thead-light>
                              <tr>
                                <th scope="col">Organism</th>
                                <th scope="col">UniprotID</th>
                                <th scope="col">PDB</th>
                                <th scope="col">Resolution</th>
                                <th scope="col">Spatial Label</th>
                                <th scope="col">Dihedral Label</th>
                                <th scope="col">C-helix</th>
                                <th scope="col">Ligand</th>
                                <th scope="col">Type</th>
                                <th scope="col">Residues in structure</th>
                                <th scope="col" style="width:8%;">Mutation</th>
                                <th scope="col">Phosphorylation</th>
                                <th scope="col">Unresolved residues in A-loop</th>
                              </tr>
                            </thead>

                            {% for item in gene_list_2['Nonhuman'] %}
                            {% if item.specie!='Homo sapiens' %}
                            <tr>
                              <td>{{ item.specie }}</td>
                              <td>{{ item.uniprotid }}</td>
                              <td><a href="{{ url_for('uniqueQuery', queryname=item.pdb, settings='PDB') }}" target="_blank">{{ item.pdb }}</td>
                              <td>{{ item.resolution }}</td>
                              <td><a href="{{ url_for('uniqueQuery', queryname=item.spatial, settings='SPATIAL') }}" target="_blank">{{ item.spatial }}</td>
                              {% if item.dihedral=='None' %}
                              <td><a href="{{ url_for('uniqueQuery', queryname=(item.spatial+item.dihedral), settings='DIHEDRAL') }}" target="_blank">{{ item.dihedral }}</td>
                              {% else %}
                              <td><a href="{{ url_for('uniqueQuery', queryname=item.dihedral, settings='DIHEDRAL') }}" target="_blank">{{ item.dihedral }}</td>
                              {% endif %}
                              <td>{{ item.chelix }}</td>
                              {% if ',' in item.ligand %}
                              <td>
                                {% set subitems=item.ligand.split(',') %}
                                {% for ligname in subitems %}
                                {% set sub_subitems=ligname.split(':') %}
                                <a href="{{ url_for('uniqueQuery', queryname=sub_subitems[0], settings='LIGAND') }}" target="_blank">{{ sub_subitems[0] }}
                                {% endfor %}
                              </td>
                              {% else %}
                              {% set ligname=item.ligand.split(':') %}
                              <td><a href="{{ url_for('uniqueQuery', queryname=ligname[0], settings='LIGAND') }}" target="_blank">{{ ligname[0] }}</td>
                              {% endif %}
                              {% if ',' in item.ligand_type %}
                              <td>
                              {% set subitems=item.ligand_type.split(',') %}
                              {% for ligtypes in subitems %}
                              <a href="{{ url_for('multipleQuery', groupSelect='All', labelSelect='All', ligTypeSelect=ligtypes) }}" target="_blank">{{ ligtypes }}
                              {% endfor %}
                            </td>
                            {% else %}
                              <td><a href="{{ url_for('multipleQuery', groupSelect='All', labelSelect='All', ligTypeSelect=item.ligand_type) }}" target="_blank">{{ item.ligand_type }}</td>
                            {% endif %}

                              <td>{{ item.first_obs_res }} - {{ item.last_obs_res }}</td>
                              <td>{{ item.chain_mut }}</td>
                              <td>{{ item.chain_phos }}</td>
                              {% if item.loopBreak>0 %}
                              <td>{{ item.loopBreak }}</td>
                              {% else %}
                              <td>0</td>
                              {% endif %}
                            </tr>
                            {% endif %}
                            {% endfor %}
                          </table>
                        </div>
                        {% endif %}
                      </div>

                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>


          <script>
            $(function () {

              $('#myTab a[href="#All"]').tab('show')
              $('#myTab a[href="#Nonhuman"]').tab('show')
              $('#myTab a[href="#Human"]').tab('show')
            })
          </script>



          <script type="text/javascript">

          var stage = new NGL.Stage( "viewport_1_human" );
          window.addEventListener( "resize", function( event ){
            stage.handleResize();
            }, false );
            stage.setParameters( { backgroundColor: "white", cameraType: "orthographic" } );

            Promise.all([

              {% for item in nglList_1 %}

              {% if 'Human'==item[0] %}

              {% for entries in nglList_1[item] %}

              {% set pdb=item[1] %}

              stage.loadFile("{{ url_for('static',filename='kinasechainsNGL/') }}{{pdb}}.pdb", {sele: ":{{ pdb[4] }}" }).then(function (o) {
            o.addRepresentation("backbone",{sele:":{{ pdb[4] }} and {{ entries.domain_begin }}-{{ entries.domain_end }}",color:"grey",radiusScale:"0.4",opacity:"0.3"});
            o.addRepresentation("backbone",{sele:":{{ pdb[4] }} and {{ entries.dfgnum }}-{{ entries.apenum }}",color:"rgb{{ entries.color }}",radiusScale:"0.4"});
            o.addRepresentation( "licorice",{sele: ":{{ pdb[4] }} and {{ entries.dfgnum }} and not hydrogen and sidechainAttached",color:"rgb{{ entries.color }}"} );
            // o.addRepresentation( "licorice",{sele: ":{{ item[4] }} and {{ entries.dfgnum-2 }}-{{ entries.dfgnum+1 }} and not hydrogen and sidechainAttached",color:"rgb{{ entries.color }}"} );
            // o.addRepresentation( "ball+stick",{sele: "{{ entries.dfgnum-2 }}-{{ entries.dfgnum+1 }} and _N",color:"blue"} );
            // o.addRepresentation( "ball+stick",{sele: "{{ entries.dfgnum-2 }}-{{ entries.dfgnum+1 }} and _O",color:"red"} );
            o.addRepresentation("licorice",{sele:"TPO or SEP or PTR"})
            return o
          }),

          {% endfor %}

          {% endif %}
          {% endfor %}

          ]).then(function (ol) {

           var pa = ol[ 0 ].structure.getPrincipalAxes();
            stage.animationControls.rotate(pa.getRotationQuaternion(), 1500);
            var duration = 1500;  // optional duration for animation, defaults to zero
            ol[0].autoView();  // focus on the whole structure
            ol[0].autoView('{{dfgNumReprStr_1['Human'][0]}}',duration)
          {% for item in nglList_1 %}
          {% if 'Human'==item[0] %}



              ol[{{ loop.index }}].superpose(ol[ 0 ], true)



              {% endif %}
              {% endfor %}
          });
          // create tooltip element and add to document body
          var tooltip = document.createElement("div")
          Object.assign(tooltip.style, {
          display: "none",
          position: "fixed",
          zIndex: 10,
          pointerEvents: "none",
          backgroundColor: "rgba( 0, 0, 0, 0.6 )",
          color: "lightgrey",
          padding: "8px",
          fontFamily: "sans-serif"
          })
          document.body.appendChild(tooltip)

          // remove default hoverPick mouse action
          stage.mouseControls.remove("hoverPick")

          // listen to `hovered` signal to move tooltip around and change its text
          stage.signals.hovered.add(function (pickingProxy) {
          if (pickingProxy && (pickingProxy.atom || pickingProxy.bond)) {
            var atom = pickingProxy.atom || pickingProxy.closestBondAtom
            var mp = pickingProxy.mouse.position
            tooltip.innerText = atom.chainname + ": " + atom.resname +atom.resno
            tooltip.style.bottom = window.innerHeight - mp.y + 3 + "px"
            tooltip.style.left = mp.x + 3 + "px"
            tooltip.style.display = "block"
          } else {
            tooltip.style.display = "none"
          }
          });
          </script>

          <script type="text/javascript">

          document.addEventListener("DOMContentLoaded", function () {
            var stage = new NGL.Stage( "viewport_1_all" );
            window.addEventListener( "resize", function( event ){
              stage.handleResize();
              }, false );
              stage.setParameters( { backgroundColor: "white", cameraType: "orthographic" } );

              Promise.all([

                {% for item in nglList_1 %}

                {% if 'All'==item[0] %}

                {% for entries in nglList_1[item] %}

                {% set pdb=item[1] %}

                stage.loadFile("{{ url_for('static',filename='kinasechainsNGL/') }}{{pdb}}.pdb", {sele: ":{{ pdb[4] }}" }).then(function (o) {
              o.addRepresentation("backbone",{sele:":{{ pdb[4] }} and {{ entries.domain_begin }}-{{ entries.domain_end }}",color:"grey",radiusScale:"0.4",opacity:"0.3"});
              o.addRepresentation("backbone",{sele:":{{ pdb[4] }} and {{ entries.dfgnum }}-{{ entries.apenum }}",color:"rgb{{ entries.color }}",radiusScale:"0.4"});
              o.addRepresentation( "licorice",{sele: ":{{ pdb[4] }} and {{ entries.dfgnum }} and not hydrogen and sidechainAttached",color:"rgb{{ entries.color }}"} );
              // o.addRepresentation( "licorice",{sele: ":{{ item[4] }} and {{ entries.dfgnum-2 }}-{{ entries.dfgnum+1 }} and not hydrogen and sidechainAttached",color:"rgb{{ entries.color }}"} );
              // o.addRepresentation( "ball+stick",{sele: "{{ entries.dfgnum-2 }}-{{ entries.dfgnum+1 }} and _N",color:"blue"} );
              // o.addRepresentation( "ball+stick",{sele: "{{ entries.dfgnum-2 }}-{{ entries.dfgnum+1 }} and _O",color:"red"} );
              o.addRepresentation("licorice",{sele:"TPO or SEP or PTR"})
              return o
            }),

            {% endfor %}

            {% endif %}
            {% endfor %}

            ]).then(function (ol) {

             var pa = ol[ 0 ].structure.getPrincipalAxes();
              stage.animationControls.rotate(pa.getRotationQuaternion(), 1500);
              var duration = 1500;  // optional duration for animation, defaults to zero
              ol[0].autoView();  // focus on the whole structure
              ol[0].autoView('{{dfgNumReprStr_1['All'][0]}}',duration)
                {% set count=namespace(value=1) %}
            {% for item in nglList_1 %}
            {% if 'All'==item[0] %}

              ol[{{ count.value }}].superpose(ol[ 0 ], true)
              {% set count.value=count.value+1 %}
                {% endif %}
                {% endfor %}
            });
            // create tooltip element and add to document body
            var tooltip = document.createElement("div")
            Object.assign(tooltip.style, {
            display: "none",
            position: "fixed",
            zIndex: 10,
            pointerEvents: "none",
            backgroundColor: "rgba( 0, 0, 0, 0.6 )",
            color: "lightgrey",
            padding: "8px",
            fontFamily: "sans-serif"
            })
            document.body.appendChild(tooltip)

            // remove default hoverPick mouse action
            stage.mouseControls.remove("hoverPick")

            // listen to `hovered` signal to move tooltip around and change its text
            stage.signals.hovered.add(function (pickingProxy) {
            if (pickingProxy && (pickingProxy.atom || pickingProxy.bond)) {
              var atom = pickingProxy.atom || pickingProxy.closestBondAtom
              var mp = pickingProxy.mouse.position
              tooltip.innerText = atom.chainname + ": " + atom.resname +atom.resno
              tooltip.style.bottom = window.innerHeight - mp.y + 3 + "px"
              tooltip.style.left = mp.x + 3 + "px"
              tooltip.style.display = "block"
            } else {
              tooltip.style.display = "none"
            }
            });
          });

          </script>

          <script type="text/javascript">

          document.addEventListener("DOMContentLoaded", function () {
            var stage = new NGL.Stage( "viewport_1_nonhuman" );
            window.addEventListener( "resize", function( event ){
              stage.handleResize();
              }, false );
              stage.setParameters( { backgroundColor: "white", cameraType: "orthographic" } );

              Promise.all([

                {% for item in nglList_1 %}

                {% if item[0]=='Nonhuman' %}

                {% for entries in nglList_1[item] %}

                {% set pdb=item[1] %}

                stage.loadFile("{{ url_for('static',filename='kinasechainsNGL/') }}{{pdb}}.pdb", {sele: ":{{ pdb[4] }}" }).then(function (o) {
              o.addRepresentation("backbone",{sele:":{{ pdb[4] }} and {{ entries.domain_begin }}-{{ entries.domain_end }}",color:"grey",radiusScale:"0.4",opacity:"0.3"});
              o.addRepresentation("backbone",{sele:":{{ pdb[4] }} and {{ entries.dfgnum }}-{{ entries.apenum }}",color:"rgb{{ entries.color }}",radiusScale:"0.4"});
              o.addRepresentation( "licorice",{sele: ":{{ pdb[4] }} and {{ entries.dfgnum }} and not hydrogen and sidechainAttached",color:"rgb{{ entries.color }}"} );
              // o.addRepresentation( "licorice",{sele: ":{{ item[4] }} and {{ entries.dfgnum-2 }}-{{ entries.dfgnum+1 }} and not hydrogen and sidechainAttached",color:"rgb{{ entries.color }}"} );
              // o.addRepresentation( "ball+stick",{sele: "{{ entries.dfgnum-2 }}-{{ entries.dfgnum+1 }} and _N",color:"blue"} );
              // o.addRepresentation( "ball+stick",{sele: "{{ entries.dfgnum-2 }}-{{ entries.dfgnum+1 }} and _O",color:"red"} );
              o.addRepresentation("licorice",{sele:"TPO or SEP or PTR"})
              return o
            }),

            {% endfor %}

            {% endif %}
            {% endfor %}

          ]).then(function (ol) {

             var pa = ol[ 0 ].structure.getPrincipalAxes();
              stage.animationControls.rotate(pa.getRotationQuaternion(), 1500);
              var duration = 1500;  // optional duration for animation, defaults to zero
              ol[0].autoView();  // focus on the whole structure
              ol[0].autoView('{{dfgNumReprStr_1['Nonhuman'][0]}}',duration)

            {% set count=namespace(value=1) %}
            {% for item in nglList_1 %}

            {% if item[0]=='Nonhuman' %}

                ol[{{ count.value }}].superpose(ol[ 0 ], true)
                {% set count.value=count.value+1 %}

                {% endif %}
                {% endfor %}
            });
            // create tooltip element and add to document body
            var tooltip = document.createElement("div")
            Object.assign(tooltip.style, {
            display: "none",
            position: "fixed",
            zIndex: 10,
            pointerEvents: "none",
            backgroundColor: "rgba( 0, 0, 0, 0.6 )",
            color: "lightgrey",
            padding: "8px",
            fontFamily: "sans-serif"
            })
            document.body.appendChild(tooltip)

            // remove default hoverPick mouse action
            stage.mouseControls.remove("hoverPick")

            // listen to `hovered` signal to move tooltip around and change its text
            stage.signals.hovered.add(function (pickingProxy) {
            if (pickingProxy && (pickingProxy.atom || pickingProxy.bond)) {
              var atom = pickingProxy.atom || pickingProxy.closestBondAtom
              var mp = pickingProxy.mouse.position
              tooltip.innerText = atom.chainname + ": " + atom.resname +atom.resno
              tooltip.style.bottom = window.innerHeight - mp.y + 3 + "px"
              tooltip.style.left = mp.x + 3 + "px"
              tooltip.style.display = "block"
            } else {
              tooltip.style.display = "none"
            }
            });
          });

          </script>

          <script type="text/javascript">

          var stage = new NGL.Stage( "viewport_2_human" );
          window.addEventListener( "resize", function( event ){
            stage.handleResize();
            }, false );
            stage.setParameters( { backgroundColor: "white", cameraType: "orthographic" } );

            Promise.all([

              {% for item in nglList_2 %}

              {% if 'Human'==item[0] %}

              {% for entries in nglList_2[item] %}

              {% set pdb=item[1] %}

              stage.loadFile("{{ url_for('static',filename='kinasechainsNGL/') }}{{pdb}}.pdb", {sele: ":{{ pdb[4] }}" }).then(function (o) {
            o.addRepresentation("backbone",{sele:":{{ pdb[4] }} and {{ entries.domain_begin }}-{{ entries.domain_end }}",color:"grey",radiusScale:"0.4",opacity:"0.3"});
            o.addRepresentation("backbone",{sele:":{{ pdb[4] }} and {{ entries.dfgnum }}-{{ entries.apenum }}",color:"rgb{{ entries.color }}",radiusScale:"0.4"});
            o.addRepresentation( "licorice",{sele: ":{{ pdb[4] }} and {{ entries.dfgnum }} and not hydrogen and sidechainAttached",color:"rgb{{ entries.color }}"} );
            // o.addRepresentation( "licorice",{sele: ":{{ item[4] }} and {{ entries.dfgnum-2 }}-{{ entries.dfgnum+1 }} and not hydrogen and sidechainAttached",color:"rgb{{ entries.color }}"} );
            // o.addRepresentation( "ball+stick",{sele: "{{ entries.dfgnum-2 }}-{{ entries.dfgnum+1 }} and _N",color:"blue"} );
            // o.addRepresentation( "ball+stick",{sele: "{{ entries.dfgnum-2 }}-{{ entries.dfgnum+1 }} and _O",color:"red"} );
            o.addRepresentation("licorice",{sele:"TPO or SEP or PTR"})
            return o
          }),

          {% endfor %}

          {% endif %}
          {% endfor %}

          ]).then(function (ol) {

           var pa = ol[ 0 ].structure.getPrincipalAxes();
            stage.animationControls.rotate(pa.getRotationQuaternion(), 1500);
            var duration = 1500;  // optional duration for animation, defaults to zero
            ol[0].autoView();  // focus on the whole structure
            ol[0].autoView('{{dfgNumReprStr_2['Human'][0]}}',duration)
          {% for item in nglList_2 %}
          {% if 'Human'==item[0] %}



              ol[{{ loop.index }}].superpose(ol[ 0 ], true)



              {% endif %}
              {% endfor %}
          });
          // create tooltip element and add to document body
          var tooltip = document.createElement("div")
          Object.assign(tooltip.style, {
          display: "none",
          position: "fixed",
          zIndex: 10,
          pointerEvents: "none",
          backgroundColor: "rgba( 0, 0, 0, 0.6 )",
          color: "lightgrey",
          padding: "8px",
          fontFamily: "sans-serif"
          })
          document.body.appendChild(tooltip)

          // remove default hoverPick mouse action
          stage.mouseControls.remove("hoverPick")

          // listen to `hovered` signal to move tooltip around and change its text
          stage.signals.hovered.add(function (pickingProxy) {
          if (pickingProxy && (pickingProxy.atom || pickingProxy.bond)) {
            var atom = pickingProxy.atom || pickingProxy.closestBondAtom
            var mp = pickingProxy.mouse.position
            tooltip.innerText = atom.chainname + ": " + atom.resname +atom.resno
            tooltip.style.bottom = window.innerHeight - mp.y + 3 + "px"
            tooltip.style.left = mp.x + 3 + "px"
            tooltip.style.display = "block"
          } else {
            tooltip.style.display = "none"
          }
          });
          </script>

          <script type="text/javascript">

          document.addEventListener("DOMContentLoaded", function () {
            var stage = new NGL.Stage( "viewport_2_all" );
            window.addEventListener( "resize", function( event ){
              stage.handleResize();
              }, false );
              stage.setParameters( { backgroundColor: "white", cameraType: "orthographic" } );

              Promise.all([

                {% for item in nglList_2 %}

                {% if 'All'==item[0] %}

                {% for entries in nglList_2[item] %}

                {% set pdb=item[1] %}

                stage.loadFile("{{ url_for('static',filename='kinasechainsNGL/') }}{{pdb}}.pdb", {sele: ":{{ pdb[4] }}" }).then(function (o) {
              o.addRepresentation("backbone",{sele:":{{ pdb[4] }} and {{ entries.domain_begin }}-{{ entries.domain_end }}",color:"grey",radiusScale:"0.4",opacity:"0.3"});
              o.addRepresentation("backbone",{sele:":{{ pdb[4] }} and {{ entries.dfgnum }}-{{ entries.apenum }}",color:"rgb{{ entries.color }}",radiusScale:"0.4"});
              o.addRepresentation( "licorice",{sele: ":{{ pdb[4] }} and {{ entries.dfgnum }} and not hydrogen and sidechainAttached",color:"rgb{{ entries.color }}"} );
              // o.addRepresentation( "licorice",{sele: ":{{ item[4] }} and {{ entries.dfgnum-2 }}-{{ entries.dfgnum+1 }} and not hydrogen and sidechainAttached",color:"rgb{{ entries.color }}"} );
              // o.addRepresentation( "ball+stick",{sele: "{{ entries.dfgnum-2 }}-{{ entries.dfgnum+1 }} and _N",color:"blue"} );
              // o.addRepresentation( "ball+stick",{sele: "{{ entries.dfgnum-2 }}-{{ entries.dfgnum+1 }} and _O",color:"red"} );
              o.addRepresentation("licorice",{sele:"TPO or SEP or PTR"})
              return o
            }),

            {% endfor %}

            {% endif %}
            {% endfor %}

            ]).then(function (ol) {

             var pa = ol[ 0 ].structure.getPrincipalAxes();
              stage.animationControls.rotate(pa.getRotationQuaternion(), 1500);
              var duration = 1500;  // optional duration for animation, defaults to zero
              ol[0].autoView();  // focus on the whole structure
              ol[0].autoView('{{dfgNumReprStr_2['All'][0]}}',duration)
                {% set count=namespace(value=1) %}
            {% for item in nglList_2 %}
            {% if 'All'==item[0] %}

              ol[{{ count.value }}].superpose(ol[ 0 ], true)
              {% set count.value=count.value+1 %}
                {% endif %}
                {% endfor %}
            });
            // create tooltip element and add to document body
            var tooltip = document.createElement("div")
            Object.assign(tooltip.style, {
            display: "none",
            position: "fixed",
            zIndex: 10,
            pointerEvents: "none",
            backgroundColor: "rgba( 0, 0, 0, 0.6 )",
            color: "lightgrey",
            padding: "8px",
            fontFamily: "sans-serif"
            })
            document.body.appendChild(tooltip)

            // remove default hoverPick mouse action
            stage.mouseControls.remove("hoverPick")

            // listen to `hovered` signal to move tooltip around and change its text
            stage.signals.hovered.add(function (pickingProxy) {
            if (pickingProxy && (pickingProxy.atom || pickingProxy.bond)) {
              var atom = pickingProxy.atom || pickingProxy.closestBondAtom
              var mp = pickingProxy.mouse.position
              tooltip.innerText = atom.chainname + ": " + atom.resname +atom.resno
              tooltip.style.bottom = window.innerHeight - mp.y + 3 + "px"
              tooltip.style.left = mp.x + 3 + "px"
              tooltip.style.display = "block"
            } else {
              tooltip.style.display = "none"
            }
            });
          });

          </script>

          <script type="text/javascript">

          document.addEventListener("DOMContentLoaded", function () {
            var stage = new NGL.Stage( "viewport_2_nonhuman" );
            window.addEventListener( "resize", function( event ){
              stage.handleResize();
              }, false );
              stage.setParameters( { backgroundColor: "white", cameraType: "orthographic" } );

              Promise.all([

                {% for item in nglList_2 %}

                {% if item[0]=='Nonhuman' %}

                {% for entries in nglList_2[item] %}

                {% set pdb=item[1] %}

                stage.loadFile("{{ url_for('static',filename='kinasechainsNGL/') }}{{pdb}}.pdb", {sele: ":{{ pdb[4] }}" }).then(function (o) {
              o.addRepresentation("backbone",{sele:":{{ pdb[4] }} and {{ entries.domain_begin }}-{{ entries.domain_end }}",color:"grey",radiusScale:"0.4",opacity:"0.3"});
              o.addRepresentation("backbone",{sele:":{{ pdb[4] }} and {{ entries.dfgnum }}-{{ entries.apenum }}",color:"rgb{{ entries.color }}",radiusScale:"0.4"});
              o.addRepresentation( "licorice",{sele: ":{{ pdb[4] }} and {{ entries.dfgnum }} and not hydrogen and sidechainAttached",color:"rgb{{ entries.color }}"} );
              // o.addRepresentation( "licorice",{sele: ":{{ item[4] }} and {{ entries.dfgnum-2 }}-{{ entries.dfgnum+1 }} and not hydrogen and sidechainAttached",color:"rgb{{ entries.color }}"} );
              // o.addRepresentation( "ball+stick",{sele: "{{ entries.dfgnum-2 }}-{{ entries.dfgnum+1 }} and _N",color:"blue"} );
              // o.addRepresentation( "ball+stick",{sele: "{{ entries.dfgnum-2 }}-{{ entries.dfgnum+1 }} and _O",color:"red"} );
              o.addRepresentation("licorice",{sele:"TPO or SEP or PTR"})
              return o
            }),

            {% endfor %}

            {% endif %}
            {% endfor %}

          ]).then(function (ol) {

             var pa = ol[ 0 ].structure.getPrincipalAxes();
              stage.animationControls.rotate(pa.getRotationQuaternion(), 1500);
              var duration = 1500;  // optional duration for animation, defaults to zero
              ol[0].autoView();  // focus on the whole structure
              ol[0].autoView('{{dfgNumReprStr_2['Nonhuman'][0]}}',duration)

            {% set count=namespace(value=1) %}
            {% for item in nglList_2 %}

            {% if item[0]=='Nonhuman' %}

                ol[{{ count.value }}].superpose(ol[ 0 ], true)
                {% set count.value=count.value+1 %}

                {% endif %}
                {% endfor %}
            });
            // create tooltip element and add to document body
            var tooltip = document.createElement("div")
            Object.assign(tooltip.style, {
            display: "none",
            position: "fixed",
            zIndex: 10,
            pointerEvents: "none",
            backgroundColor: "rgba( 0, 0, 0, 0.6 )",
            color: "lightgrey",
            padding: "8px",
            fontFamily: "sans-serif"
            })
            document.body.appendChild(tooltip)

            // remove default hoverPick mouse action
            stage.mouseControls.remove("hoverPick")

            // listen to `hovered` signal to move tooltip around and change its text
            stage.signals.hovered.add(function (pickingProxy) {
            if (pickingProxy && (pickingProxy.atom || pickingProxy.bond)) {
              var atom = pickingProxy.atom || pickingProxy.closestBondAtom
              var mp = pickingProxy.mouse.position
              tooltip.innerText = atom.chainname + ": " + atom.resname +atom.resno
              tooltip.style.bottom = window.innerHeight - mp.y + 3 + "px"
              tooltip.style.left = mp.x + 3 + "px"
              tooltip.style.display = "block"
            } else {
              tooltip.style.display = "none"
            }
            });
          });

          </script>

  {% endblock %}
  </body>

</html>
